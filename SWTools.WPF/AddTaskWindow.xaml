<Window x:Class="SWTools.WPF.AddTaskWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SWTools.WPF"
        xmlns:viewmodel="clr-namespace:SWTools.ViewModel;assembly=SWTools.ViewModel"
        mc:Ignorable="d"
        Title="添加下载任务"
        Height="580" Width="820"
        MinHeight="400" MinWidth="800"
        Background="{StaticResource BgDefault}"
        WindowStartupLocation="CenterOwner" ShowInTaskbar="False"
        RenderOptions.BitmapScalingMode="HighQuality">
    <Window.DataContext>
        <viewmodel:AddTaskWindow/>
    </Window.DataContext>

    <DockPanel>
        <!--底栏-->
        <DockPanel DockPanel.Dock="Bottom" LastChildFill="False" Background="{StaticResource BgGray}">
            <Button x:Name="BtnOk" Margin="10 10 20 10" Height="40" DockPanel.Dock="Right"
                    Style="{DynamicResource AccentButtonStyle}" Click="BtnOk_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock FontFamily="{StaticResource SymbolThemeFontFamily}" Text="&#xE8FB;" VerticalAlignment="Center" Margin="0 0 10 0"/>
                    <TextBlock Text="确定"/>
                </StackPanel>
            </Button>
            <TextBlock DockPanel.Dock="Left" VerticalAlignment="Center" Margin="20 10 10 10"
                       Text="提示：输入要下载的 ID → 解析信息 → 补充缺失的信息（如有）→ 完成"/>
        </DockPanel>
        <Separator DockPanel.Dock="Bottom" BorderBrush="#d4d4d4"/>
        <ProgressBar x:Name="ProgressBar" DockPanel.Dock="Bottom" IsIndeterminate="{Binding IsIndeterminate}"
                     Background="Transparent"/>

        <DockPanel Margin="20 20 20 10">
            <!--物品ID输入-->
            <DockPanel Margin="0 0 10 0" Width="300" DockPanel.Dock="Left">
                <TextBlock Text="在下面输入要下载的物品 ID（一行一个 ID）" DockPanel.Dock="Top"/>
                <DockPanel LastChildFill="False" DockPanel.Dock="Bottom">
                    <Button x:Name="BtnParse"  Height="40" DockPanel.Dock="Right" Style="{DynamicResource AccentButtonStyle}" 
                            IsEnabled="{Binding IsBtnParseEnable}" Click="BtnParse_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="{StaticResource SymbolThemeFontFamily}" Text="&#xF6FA;" VerticalAlignment="Center" Margin="0 0 10 0"/>
                            <TextBlock Text="解析信息"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="BtnHelpItem"  Height="40" DockPanel.Dock="Left"
                            Click="BtnHelpItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="{StaticResource SymbolThemeFontFamily}" Text="&#xE897;" VerticalAlignment="Center" Margin="0 0 10 0"/>
                            <TextBlock Text="什么是物品 ID"/>
                        </StackPanel>
                    </Button>
                </DockPanel>
                <TextBox TextWrapping="Wrap" AcceptsReturn="True" Margin="0 10 0 10" VerticalScrollBarVisibility="Auto"
                          x:Name="TextBox" Text="{Binding ItemsToDownload}" TextChanged="TextBox_TextChanged"/>
            </DockPanel>
            <Separator DockPanel.Dock="Left" BorderBrush="#d4d4d4" Margin="0 20 0 20"/>
            <!--解析列表-->
            <DockPanel Margin="10 0 0 0">
                <TextBlock Text="解析列表" DockPanel.Dock="Top"/>
                <DockPanel DockPanel.Dock="Bottom">
                    <TextBlock Text="App ID：" VerticalAlignment="Center"/>
                    <Button x:Name="BtnHelpApp"  Height="40" DockPanel.Dock="Right" Margin="5 0 5 0"
                            Click="BtnHelpApp_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="{StaticResource SymbolThemeFontFamily}" Text="&#xE897;" VerticalAlignment="Center" Margin="0 0 10 0"/>
                            <TextBlock Text="什么是 App ID"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="BtnEdit"  Height="40" DockPanel.Dock="Right" Margin="5 0 0 0"
                            IsEnabled="False" Click="BtnEdit_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontFamily="{StaticResource SymbolThemeFontFamily}" Text="&#xE70F;" VerticalAlignment="Center" Margin="0 0 10 0"/>
                            <TextBlock Text="修改信息"/>
                        </StackPanel>
                    </Button>
                    <TextBox x:Name="TextBoxAppId" Height="35" VerticalAlignment="Center" Margin="5 0 5 0" DockPanel.Dock="Left"/>
                </DockPanel>
                <ListView ItemsSource="{Binding DisplayItems}" FontSize="13" Background="{StaticResource BgLight}" Margin="0 10 0 10"
                          SelectionChanged="ListView_SelectionChanged" x:Name="ListView">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="名称" Width="150">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock TextTrimming="CharacterEllipsis" Text="{Binding ItemName}" ToolTip="{Binding ItemName}" 
                                   ToolTipService.InitialShowDelay="300"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="适用的 App" Width="150">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock TextTrimming="CharacterEllipsis" Text="{Binding AppName}" ToolTip="{Binding AppName}"
                                   ToolTipService.InitialShowDelay="300"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="解析状态" Width="150" DisplayMemberBinding="{Binding State}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </DockPanel>
        </DockPanel>
    </DockPanel>
</Window>
